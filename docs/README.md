# SQL Server Import Files

## ไฟล์ SQL ที่จำเป็น

### 1. `create_tables_ultra_safe.sql`
- **ใช้สำหรับ**: สร้างตารางใน SQL Server
- **ลักษณะ**: ไม่มี Identity properties, ไม่มี Foreign Keys
- **ขนาดคอลัมน์**: ปรับให้ปลอดภัยสูงสุดสำหรับ Import Wizard

### 2. `add_foreign_keys.sql`
- **ใช้สำหรับ**: เพิ่ม Foreign Keys หลังจากนำเข้าข้อมูลแล้ว
- **ลักษณะ**: ตรวจสอบข้อมูลก่อนเพิ่ม Foreign Key
- **รันเมื่อ**: หลังจากนำเข้าข้อมูล CSV ทั้งหมดแล้ว

### 3. `check_data.sql`
- **ใช้สำหรับ**: ตรวจสอบข้อมูลหลังนำเข้า
- **ลักษณะ**: แสดงจำนวนแถว, ข้อมูลตัวอย่าง, Foreign Keys, Indexes
- **รันเมื่อ**: หลังจากเพิ่ม Foreign Keys แล้ว

## ไฟล์ CSV ที่จำเป็น

### ไฟล์ CSV ที่จำเป็น (ในโฟลเดอร์ `fixed/`)
- `collars.csv` - ข้อมูลตำแหน่งหลุมเจาะ
- `rock_types.csv` - ข้อมูลประเภทหิน
- `seam_codes.csv` - ข้อมูลรหัสชั้นถ่านหิน
- `lithology_logs_ultra_clean.csv` - ข้อมูลบันทึกธรณีวิทยา (ใช้ไฟล์นี้)
- `sample_analyses.csv` - ข้อมูลการวิเคราะห์ตัวอย่าง

## ไฟล์คำแนะนำ

### 1. `IMPORT_WIZARD_SETTINGS.md`
- **ใช้สำหรับ**: การตั้งค่า SQL Server Import Wizard
- **เนื้อหา**: ขั้นตอนการนำเข้าข้อมูล, การแก้ไขปัญหา

### 2. `IMPORT_INSTRUCTIONS.md`
- **ใช้สำหรับ**: คำแนะนำการนำเข้าข้อมูลแบบ Manual
- **เนื้อหา**: ขั้นตอนการใช้งาน, การแก้ไขปัญหา

## ไฟล์ Python (สำหรับแก้ไข CSV)

### `fix_import_wizard.py`
- **ใช้สำหรับ**: สร้างไฟล์ CSV ที่ปลอดภัยสูงสุดสำหรับ Import Wizard
- **ฟังก์ชัน**: ลบอักขระพิเศษทั้งหมด, ตัดข้อความให้เหลือ 50 ตัวอักษร
- **รันเมื่อ**: ต้องการสร้างไฟล์ CSV ใหม่ที่ปลอดภัย

## ขั้นตอนการใช้งาน

1. **รัน `create_tables_ultra_safe.sql`** - สร้างตาราง
2. **นำเข้าข้อมูล CSV ด้วย SQL Server Import Wizard**:
   - ใช้ไฟล์ในโฟลเดอร์ `fixed/`
   - ตั้งค่าตาม `IMPORT_WIZARD_SETTINGS.md`
3. **รัน `add_foreign_keys.sql`** - เพิ่มความสัมพันธ์
4. **รัน `check_data.sql`** - ตรวจสอบผลลัพธ์

## หมายเหตุ

- ไฟล์ `lithology_logs_ultra_clean.csv` ได้แก้ไขอักขระพิเศษและตัดข้อความยาวแล้ว
- ตารางใช้ขนาดคอลัมน์ที่ปลอดภัยสูงสุด
- ไม่มี Identity properties เพื่อให้สามารถนำเข้าข้อมูลได้โดยตรง
